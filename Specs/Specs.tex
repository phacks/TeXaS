\documentclass[a4paper]{report}
\makeatletter\@addtoreset{chapter}{part}\makeatother%
\usepackage[T1]{fontenc}
\usepackage[french]{babel} 
\usepackage{lmodern} % Pour changer le pack de police
\usepackage[top=2cm, bottom=2cm, left=3cm, right=3cm]{geometry}
\usepackage[final]{pdfpages} 
\usepackage{graphicx}
\usepackage{xcolor}
%------------------------------------------
%création d'une structure XML
%------------------------------------------
\usepackage{listings}
\usepackage{listings,color}
 
\definecolor{gray}{rgb}{0.4,0.4,0.4}
\definecolor{darkblue}{rgb}{0.0,0.0,0.6}
\definecolor{cyan}{rgb}{0.0,0.6,0.6}
 
\lstset{
  basicstyle=\ttfamily,
  columns=fullflexible,
  showstringspaces=false,
  commentstyle=\color{gray}\upshape
}
 
\lstdefinelanguage{XML}
{
  basicstyle=\ttfamily\color{darkblue}\bfseries,
  morestring=[b]",
  morestring=[s]{>}{<},
  morecomment=[s]{<?}{?>},
  stringstyle=\color{black},
  identifierstyle=\color{darkblue},
  keywordstyle=\color{cyan},
  morekeywords={xmlns,version,type}% list your attributes here
}

%------------------------------------------
%création d'un sommaire cliquable
%------------------------------------------
\usepackage{hyperref} % Créer des liens et des signets 
\hypersetup{	
hypertexnames=false,
colorlinks=true, %colorise les liens 
breaklinks=true, %permet le retour à la ligne dans les liens trop longs 
urlcolor= blue, %couleur des hyperliens 
linkcolor= black,	%couleur des liens internes 
citecolor=black,	%couleur des références 
pdftitle={TeXaS : Spécifications}, %informations apparaissant dans 
pdfauthor={K \& N}, %les informations du document 
pdfsubject={TeXaS}	%sous Acrobat. 
}

\usepackage{makeidx}
\title{TeXaS : Spécifications}
\author{K \& N}
\date{\today} % Pour mettre la date du jour, tapez \today 
\makeindex

\begin{document}

\maketitle

\lstset{language=XML}

\tableofcontents

%----------------------------------
% PARTIE : Fonctionnalités
%----------------------------------
\part{Fonctionnalités}

\chapter{TeXaS : vue d'ensemble des fonctionnalités}

\emph{L'ensemble des fonctionnalités présentées ici sont détaillées dans les chapitres suivants. Ce chapitre effectue un recensement général des fonctionnalités générale du logiciel, facilitant la compréhension du projet}.

\section{Création de document}

Lors de la création d'un document, l'utilisateur \emph{doit} choisir parmis les 6 gabarits (ou templates) proposés (rapports de stage, de projet, lettre, etc.).

Le logiciel laisse à l'utilisateur le choix entre mode par défaut (afin de se concentrer sur le contenu, pas sur la forme, qui est définie par défaut) et mode personnalisé (choix de personnalisation avancés, pour la page de garde, les entêtes, etc.).

Enfin, il définit les informations de son document (si celles-ci son nécessaires) : nom de l'auteur, nom du document, dates, etc.

\section{Rédaction de document}

La rédaction du document s'effectue dans une interface de type WYSIWYM\footnote{What you see is what you get}.

La saisie de texte s'effectue directement sur celle-ci, alors que les éléments hors textes (mathématiques, tableaux, matrices, figures, titres, etc.) son créés à l'aide d'un ruban de création.

Sur la droite s'affiche un plan détaillé du document, facilitant la navigation dans le projet.

Les menus sont affichés à gauche et à droite du document.

\section{Visualisation du document}

Le document est visualisable en format pdf, ouvert dans le lecteur par défaut de l'utilisateur (pas de pdf reader dans le logiciel). 

Pour ce, le logiciel crée un fichier XML généré \emph{en continu} tout au long de la création du document par l'utilisateur. 

Ce fichier XML est ensuite converti en un code LaTeX qui est compilé et rendu en pdf.


\chapter{Création du document}

\section{Gabarits proposés}

Il s'agit des gabarits proposés à l'utilisateur pour créer son document :
\begin{itemize}
	\item Rapport de stage
	\item Rapport de projet
	\item Lettre formelle (de motivation, par ex.)
	\item Cours
	\item Fiche de révision
	\item Article court (essai anglais, par ex.)
\end{itemize}

\subsection{Rapport de stage}

Gabarit permettant à l'utilisateur de créer son rapport de stage (1\up{ère}, 2\up{ème}, etc. année). 

Visible sur la figure \ref{Template : Rapport de stage}.

\begin{center}
\begin{figure}%
\includegraphics[width=\columnwidth]{Templates/rapportStageTemplate1.pdf}
\caption{Template : Rapport de stage}%
\label{Template : Rapport de stage}%
\end{figure}
\end{center}

\subsection{Rapport de projet}

Gabarit permettant à l'utilisateur de créer son rapport de projet.

Visible sur la figure \ref{Template : Rapport de projet}

\begin{center}
\begin{figure}%
\includegraphics[width=\columnwidth]{Templates/rapportProjetTemplate.pdf}
\caption{Template : Rapport de projet}%
\label{Template : Rapport de projet}%
\end{figure}
\end{center}

\subsection{Lettre formelle}

Gabarit permettant à l'utilisateur d'écrire une lettre formelle (une lettre de motivation par exemple).

Visible sur la figure \ref{Template : Lettre}

\begin{center}
\begin{figure}%
\includegraphics[width=\columnwidth]{Templates/lettre.pdf}
\caption{Template : Lettre}%
\label{Template : Lettre}%
\end{figure}
\end{center}

\subsection{Cours}


Gabarit permettant à l'utilisateur d'écrire un cours (cours magistral à Supélec par exemple).

Visible sur la figure \ref{Template : Cours}

\begin{center}
\begin{figure}%
\includegraphics[width=\columnwidth]{Templates/coursTemplate.pdf}
\caption{Template : Cours}%
\label{Template : Cours}%
\end{figure}
\end{center}

\subsection{Fiche de révision}


Gabarit permettant à l'utilisateur de créer des fiches de révisions (ou mémo).

Visible sur la figure \ref{Template : Mémo}

\begin{center}
\begin{figure}%
\includegraphics[width=\columnwidth]{Templates/memoTemplate.pdf}
\caption{Template : Mémo}%
\label{Template : Mémo}%
\end{figure}
\end{center}

\subsection{Article court}


Gabarit permettant à l'utilisateur d'écrire un cours article (pour un essai d'anglais, une description de projet personnalisé, etc.).

Visible sur la figure \ref{Template : Article court}

\begin{center}
\begin{figure}[h]%
\includegraphics[width=12cm]{Templates/articleTemplate.pdf}
\caption{Template : Article court}%
\label{Template : Article court}%
\end{figure}
\end{center}

\clearpage
\section{Mode par défaut / personnalisé}

\subsection{Mode par défaut}

La définition des propriétés du document est automatique.

Il y a donc la génération du code (LaTeX et XML) formant la base du document.

Les codes générés automatiques sont disponible en annexe \ref{Code LaTeX : Rapport de stage} à \ref{Code LaTeX : Lettre formelle}.

\subsection{Mode personnalisé}




%----------------------------------
% PARTIE : Ergonomie
%----------------------------------
\part{Ergonomie}
\chapter{Présentation générale}

\section{Philosophie}
Une des caractéristiques les plus cruciales du logiciel doit être sa capacité à être utilisé de la manière la plus intuitive qui soit, de manière à ce que même un débutant total de LaTeX puisse l'exploiter à son maximum sans avoir à rentrer dans le code ``en dur''.\\

De plus, lorsque nous avons étudié les interfaces LaTeX en WYSIWYM qui sont déjà sur le marché (elles sont Open Source pour la plupart), nous avons remarqué que leur utilisation était basée sur une hiérarchie profonde et pénible de menus, tous situés dans la barre d'outils. Cette organisation rend, selon nous, le logiciel peu convivial et entraîne une utilisation très restreinte de l'espace.\\

C'est pourquoi nous avons voulu introduire un nouveau type d'interface, basé sur une structure claire en trois colonnes et orientée autour d'un "ruban" dynamique qui propose certains menus d'une façon beaucoup plus intuitive et facilement navigable.

\section{Structure}
L'interface du logiciel se divise en trois colonnes, ainsi qu'un ruban d'insertion dynamique. Un mockup de l'interface est donné à la figure \ref{Mockup de l'interface d'édition de texte}\\

La première colonne, la plus à gauche, regroupe les menus qui ne concernent pas directement le contenu du document. On y retrouve les items suivants : 
\begin{description}
\item[Mon projet :] Regroupe les actions relatives au fichier.
\item[Préférences : ] Gestion des préférences du logiciel.
\item[Personnaliser : ] Personnalisation du document.
\item[Editer le code : ] Accès direct au code LaTeX, avec possibilité de modifications.
\item[Exporter en PDF : ] Exporte le document en PDF.
\item[Aide : ] Accès à l'aide.
\end{description}

La colonne centrale comporte l'éditeur de texte WYSIWYM à proprement parler, une barre d'outils supérieure $-$ dédiée au formatage du texte (gras, italique, souligné), à la création de listes à puces et à la gestion des indices/exposants $-$ et d'un bouton d'accès au ruban en bas.\\

La colonne de droite, quant à elle, est un récapitulatif de la structure du document, avec une présentation de l'arborescence de celui-ci. Les différents titres seront cliquables et fonctionneront à la manière des ancres d'une page web.

\begin{center}
\begin{figure}%
\includegraphics[width=\columnwidth]{Mockups/edition.png}
\caption{Mockup de l'interface d'édition de texte}%
\label{Mockup de l'interface d'édition de texte}%
\end{figure}
\end{center}

\section{Technologies employées}
L'interface graphique sera codée à l'aide de la librairie Swing de Java.

\chapter{Insertion via le ruban}


\chapter{Menus de gauche}


%----------------------------------
% PARTIE : Algorithmes
%----------------------------------
\part{Algorithmes}
\chapter{XML vers LaTeX}
\chapter{Saisie vers XML}
\chapter{Formule vers XML}


%----------------------------------
% PARTIE : Annexes
%----------------------------------

\appendix

\part*{Annexes}
\addcontentsline{toc}{part}{Annexes}

\chapter{Création de document}

\section{Mode par défaut}

\subsection{Code LaTeX : Rapport de stage}
\label{Code LaTeX : Rapport de stage}

Ce document utilise une classe de document personnalisé : la classe rapport.

Voici le code (fichier .cls) correspondant -- les champs Prénom Nom étant complétés par les valeurs correcte de l'utilisateur:

\begin{verbatim}
% Classe rapport.cls - Version 1.0
% Ki.D sep 2012
%
\NeedsTeXFormat{LaTeX2e}[2011/06/27]
\ProvidesClass{rapport}[2012/09/18 v1.0 Classe rapport Rapport de Stage]
\LoadClass[DIV=12]{scrreprt}
\RequirePackage{calc}
\RequirePackage{color}
\RequirePackage{fancyhdr}

\definecolor{chapterCoul}{rgb}{.21,.37,.57}

\definecolor{sectionCoul}{rgb}{.31,.51,.74}

\renewcommand{\thechapter}{\Roman{chapter}}

\renewcommand{\@makechapterhead}[1]{%
	\color{chapterCoul}
  \vspace*{50\p@}%
  {\parindent \z@ \raggedright \normalfont
    \ifnum \c@secnumdepth >\m@ne
        \huge\scshape \space \thechapter . \space % Chapter number
        \nobreak
    \fi
    \huge  \scshape #1\par               % chapter title
    \vspace{5pt}%                        % add vertical space
    \hrule                               % horizontal rule
    \nobreak
    \vskip 40\p@
  }
  \color{black}
  }

\renewcommand{\@makeschapterhead}[1]{%
	\color{chapterCoul}
  \vspace*{50\p@}%
  {\parindent \z@ \raggedright
    \normalfont
    \interlinepenalty\@M
    \huge \scshape #1\par                % chapter title
    \vspace{5pt}%                        % add vertical space
    \hrule                               % horizontal line
    \nobreak
    \vskip 40\p@
  }
  \color{black}
  }
  
  \renewcommand\section{
  \@startsection {section}{1}{\z@}%
                                   {-3.5ex \@plus -1ex \@minus -.2ex}%
                                   {2.3ex \@plus.2ex}%
                                   {\color{sectionCoul}\normalfont\Large}}
  
\fancypagestyle{plain}{%
  \fancyhf{}\fancyfoot[R]{
  \footnotesize Rapport de stage de type exécution, Prénom Nom $\bullet$ \thepage}
  \renewcommand{\headrulewidth}{0pt}
  \renewcommand{\footrulewidth}{0.2pt}}
\end{verbatim}

\ \\

\hrule
\ \\

Le code généré est le suivant :

\begin{verbatim}

\documentclass{rapport}
\usepackage[latin1]{inputenc} %package encodage
\usepackage[T1]{fontenc} %package encodage
\usepackage[francais]{babel} %package encodage
\usepackage{eurosym} %symbole euro
\usepackage{graphicx} %insertion de figures
\usepackage{array} %tableaux plus personnalisé 
\usepackage{multirow} %permet la fusion dans les tableaux
\usepackage{calc} %permet de calculer dans les commandes LaTeX

%Liens cliquables
\usepackage{hyperref} % Créer des liens et des signets 
\hypersetup{	
colorlinks=true, %colorise les liens 
breaklinks=true, %permet le retour à la ligne dans les liens trop longs 
urlcolor= blue, %couleur des hyperliens 
linkcolor= black,	%couleur des liens internes 
citecolor=black,	%couleur des références 
pdftitle={Rapport de stage}, %informations apparaissant dans 
pdfauthor={Demeulemeester Kilian}, %les informations du document 
pdfsubject={Simulation}	%sous Acrobat. 
} 

\usepackage{fancyhdr}%package en tête et pied de page


\renewcommand{\labelitemi}{$\ast$} %changement des puces par défaut par des étoiles

\KOMAoptions{DIV=last}

%----------------------------------------------------------
%DEBUT DOCUMENT
%----------------------------------------------------------

\begin{document}

%mise en forme de l'en tête et pied de page
\lhead{Mon Enteprise}
\chead{}
\rhead{\sc{Supelec} \includegraphics[height=1em]{logoPelec.jpg}}
\rfoot{Rapport de stage de type exécution - Juin à Juillet 2012 $\bullet$ \thepage}
\cfoot{}
\lfoot{}
\renewcommand{\headrulewidth}{0.2pt}
\renewcommand{\footrulewidth}{0.2pt}

\pagestyle{fancy}
\tableofcontents

\end{document}

\end{verbatim}

\ \\

\hrule
\ \\

Le fichier xml correspondant est le suivant :

\begin{lstlisting}
<?xml version= "1.0" encoding="ISO-8859-1"?>
<LaTeX>
	<tete>
		<class> rapport </class>
		<packages>	
			<package> inputenc <option> latin1 </option> </package>
			<package> fontenc <option> T1 </option> </package>
			<package> babel <option> francais </option> </package>
			<package> eurosym </package>
			<package> graphics </package>
			<package> array </package>
			<package> mutlirow </package>
			<package> calc </package>
			<package> hyperref 
				<parametres>
				\hypersetup{
				colorlinks=true
				breaklinks=true
				urlcolor= blue
				linkcolor= black
				citecolor=black
				pdftitle={Rapport de stage}
				pdfauthor={Nom Prenom}
				pdfsubject={Sujet}
				}
				</parametres> 
			</package>
			<package> fancyhdr </package>
		</packages>
		<command>
			\renewcommand{\labelitemi}{$\ast$}
			\KOMAoptions{DIV=last}
		</command>
	</tete>
	<document>
		<entete>
			<lhead> Mon Entreprise </lhead>
			<chead> \sc{Supelec} \includegraphics[height=1em]{logoPelec.jpg} </chead>
			<rhead> </rhead>
			<rfoot> Rapport de stage de type execution - Juin a Juillet 2012 $\bullet$ \thepage </rfoot>
			<cfoot> </cfoot>
			<lfoot> </lfoot>
			<command>
				\renewcommand{\headrulewidth}{0.2pt}
				\renewcommand{\footrulewidth}{0.2pt}
			</command>
			<pagestyle> fancy </pagestyle>
			
		</entete>
		<command> \tableofcontents </command>
	</document>
</LaTeX>
\end{lstlisting}

\subsection{Code LaTeX : Rapport de projet}
\label{Code LaTeX : Rapport de projet}

\subsection{Code LaTeX : Lettre formelle}
\label{Code LaTeX : Lettre formelle}

\subsection{Code LaTeX : Cours}
\label{Code LaTeX : Cours}

\subsection{Code LaTeX : Fiche de révision}
\label{Code LaTeX : Fiche de révision}

\subsection{Code LaTeX : Article court}
\label{Code LaTeX : Article court}


\listoffigures
\listoftables
\printindex


\end{document}
